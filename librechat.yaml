# OptimismAI - LibreChat configuration
# https://www.librechat.ai/docs/configuration/librechat_yaml

version: 1.3.0
cache: false
autoRouter: false

# ---- Register LiteLLM (OpenAI-compatible) as a custom endpoint ----
# Your instance: 
# OpenAI-compatible base: /v1
endpoints:
  custom:
    - name: "OpenRouter"
      # For `apiKey` and `baseURL`, you can use environment variables that you define.
      # recommended environment variables:
      apiKey: "${OPENROUTER_KEY}" # NOT OPENROUTER_API_KEY
      baseURL: "https://openrouter.ai/api/v1"
      models:
        default: ["deepseek/deepseek-v3.2-exp"]
        fetch: true
      titleConvo: true
      titleModel: "deepseek/deepseek-v3.2-exp"
      summarize: true
      # Recommended: Drop the stop parameter from the request as Openrouter models use a variety of stop tokens.
      dropParams: ["stop"]
      modelDisplayLabel: "OptimismAI"
      iconURL: "/assets/logo.svg"
    - name: "Deepseek"
      apiKey: "${DEEPSEEK_API_KEY}"
      baseURL: "https://api.deepseek.com/v1"
      models:
        default: ["deepseek-chat", "deepseek-reasoner"]
        fetch: true
      titleConvo: true
      titleModel: "deepseek-chat"
      summarize: true
      modelDisplayLabel: "Deepseek"
      iconURL: "/assets/logo.svg"
# ---- Interface / UI ----
interface:
  customWelcome: "What's Your Question?, {{user.name}}?"
  privacyPolicy:
    externalUrl: "https://optimismai.app/privacy"
    openNewTab: true
  termsOfService:
    externalUrl: "https://optimismai.app/terms"
    openNewTab: true
      
  # Keep right panel but trim items
  sidePanel: true
  bookmarks: true
  prompts: false
  agents: false
  showThoughts: false
  # hides Agent Builder/Marketplace & artifacts
  viewsMenu: false
  newsMenu: false

  # Remove advanced knobs
  modelSelect: false
  parameters: false
  presets: false
  modelSelectReadOnly: true

  # Disable Code Interpreter button
  runCode: false

  # Keep web search button visible (provider is configured separately if you use it)
  webSearch: true
  fileCitations: true

# ---- Speech Configuration (Cloud Voice) ----
speech:
  tts:
    openai:
      apiKey: "${OPENAI_API_KEY}"
      model: "gpt-4o-mini-tts"
      voices:
        - alloy
        - ash
        - ballad
        - coral
        - echo
        - fable
        - nova
        - onyx
        - sage
        - shimmer
  stt:
    openai:
      apiKey: "${OPENAI_API_KEY}"
      model: "gpt-4o-mini-transcribe"
  #  realtime:
  #    apiKey: "${OPENAI_API_KEY}"
  #    model: "gpt-realtime-mini"
  #    transport: webrtc
  #    stream: true
  #    disabled: "{{ ui.disableRealtime === true }}"
  #    url: 'https://api.openai.com/v1/realtime'
  #    session:
  #      type: realtime
  #      speechToSpeech: false
  #      model: "gpt-realtime-mini"
  #      instructions: |
  #        You are OptimismAi's Agent. Respond briefly, confirm key
  #        details, and provide follow-up suggestions when helpful.
  #      audio:
  #        input:
  #          format:
  #            encoding: pcm16
  #            rate: 24000
  #            channels: 1
  #          noiseReduction:
  #            preset: server_light
  #          transcription:
  #            model: "gpt-4o-mini-transcribe"
  #            language: en
  #            temperature: 0
  #            diarization: true
  #          turnDetection:
  #            type: server_vad
  #            serverVad:
  #             enabled: true
  #              threshold: 0.5
  #              silenceDurationMs: 500
  #            semantic:
  #              enabled: false
  #              minDecisionIntervalMs: 750
  #        output:
  #          voice: alloy
  #          voices:
  #            - alloy
  #            - ash
  #            - nova
  #      modalities:
  #        - text
  #        - audio

# ---- Web Search Configuration ----
webSearch:
  searchProvider: serper
  scraperProvider: serper
  rerankerType: jina
  serperApiKey: "${SERPER_API_KEY}"
  jinaApiKey: "${JINA_API_KEY}"
  firecrawlApiKey: "${FIRECRAWL_API_KEY}"

# ---- File Uploads (multimodal ON) ----
# Remove prior 'disabled: true' rules so uploads are allowed for our endpoint.
# If you need constraints (types/size), add them here per docs; otherwise omit fileConfig entirely.
# fileConfig:
#   endpoints:
#     OptimismAI:
#       # examples:
#       # accept: ["image/*", "application/pdf"]
#       # maxFiles: 5
#       # maxSizeMB: 15

# ------ Agent Search Provider Setup -----
# ------  Memory / Personalization -----
memory:
  disabled: false
  personalize: true
  tokenLimit: 4000
  notableThreshold: 0.65
  validKeys:
    - "preferences"
    - "context"
    - "facts"
    - "name"
    - "family"
    - "projects"
    - "people"
    - "brands"
    - "goals"
    - "tasks"
    - "workflows"
    - "past"
    - "present"
    - "conversation"
    - "summary"
    - "other"
  messageWindowSize: 30
  agent:
    provider: "openAI"         # must be an AI Provider, not a custom endpoint name
    model: "gpt-4o-mini"       # pick any OpenAI chat model you have access to
    # These custom instructions are appended to the built-in memory guidance rather than replacing it.
    instructions: |
      Be open to implicitly saving information that the user has not explicitly asked to do so “remember / save / note / store,” and also save plans or commitments expressed in future tense (“I will…”, “we’ll…”, “let’s…”).
      Merge or refresh existing memories rather than duplicating, making sure to add new details without overwriting unrelated ones.
      Record summaries for conversations longer than 10 messages, and if a session ends abruptly before that point, save a partial summary for however many messages were made. 
      Save only when confidence in relevance is medium or higher. Do not save trivial, short-lived, details unless explicitly requested, and do not overwrite durable facts with temporary context. 
      Keep entries short, clear, and factual, using bullet-style for conversation summaries where needed, ensuring all memories are durable, reusable, and context-ready.
      You're able to create custom keys and store information with regards to them with reference to the 'notable threshold' system added in the memory functions code,
      don't shy away from doing so, Save concise, reusable facts such as projects, brand names, tools, tech stack, accounts, preferences, recurring goals, roles, locations, and timeframes. 
    model_parameters:
      temperature: 0.8
      max_tokens: 4096

questionFormulation:
  enabled: false
  provider: "openAI"
  model: "gpt-4o-mini"
  promptPresetKey: "question-formulation"
# ---- Lock the experience to a single, preselected model ----
modelSpecs:
  enforce: false
  list:
    - name: "optimism_companion"
      label: "OptimismAI · Companion"
      default: true
      preset:
        endpoint: "Deepseek"
        model: "deepseek-chat"
        modelLabel: "OptimismAI"
        promptPrefix: |
          Identity: OptimismAI — Clarity & Decision-Support AI.
          Core Role: Built to strengthen human judgment in ambiguous situations—thinking with the user, not for them and offers grounded optimism.
          Operating Principles:
          - Lead with empathy and curiosity; mirror the user's language before gently expanding perspective.
          - Surface practical possibilities without forcing a plan; invite the user to co-create next steps.
          - Keep the method invisible—never mention frameworks or process labels, Surfaces hidden assumption, 
          - Even if search is enabled, keep your approach question-oriented.
          Exposes reasoning constraints, Introduces alternative perspectives, Preserve user agency
          Interaction Style:
          - Use natural, human pacing with short paragraphs.
          - Ask clarifying question unapologetically.
          - End with a Decision Snapshot: What matters, what's uncertain, next action, before closing.
          Next Interaction:
          - Follow-Up Check In Loop: "What Changed Since Last Time?"
          Tools:
          - Users can toggle on search, please refrain from using search at all times when toggled, even when it is used to not disregard your core message structure
          as outlined in this prompt.
          Guardrails:
          - Avoid ambigous responses (ask questions instead) clinical diagnoses, commands, or the forbidden words (lens, reframe, pipeline, SVNS, attune, grounding).
          - Encourage autonomy, acknowledge limits, and reference resources when safety issues arise.
